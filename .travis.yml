
language: python
python:
  - "3.6"

sudo: required


script:
  - pytest --cov src/ test/ --verbose --cov-report term-missing

after_success:
  - codecov


matrix:
  include:
  - os: linux
    before_install:
      - sudo apt-get install ffmpeg ; fi
      - sudo apt-get update
      - sudo apt-get install -y xvfb herbstluftwm
      - export DISPLAY=:99.0
      - /sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -screen 0 1920x1200x24 -ac +extension GLX +render -noreset

    install:
      - pip install codecov
      - pip install -r requirements.txt

    before_script:
      - herbstluftwm &
      - sleep 3

  - os: osx
    before_install:
      - brew install ffmpeg
      install:
      - pip install codecov
      - pip install -r requiremenets.txt
