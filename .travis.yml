


sudo: required
script:
  - pytest --cov src/ test/ --verbose --cov-report term-missing
after_success:
  - codecov


matrix:
  include:
  - os: linux
    language: python
    python:
      - "3.6"
    before_install:
      - sudo apt-get install ffmpeg
      - sudo apt-get update
      - sudo apt-get install -y xvfb herbstluftwm
      - export DISPLAY=:99.0
      - /sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile --background --exec /usr/bin/Xvfb -- :99 -screen 0 1920x1200x24 -ac +extension GLX +render -noreset

    install:
      - pip install codecov
      - pip install -r requirements.txt

    before_script:
      - herbstluftwm &
      - sleep 3

  - os: osx
    language: sh
    before_install:
      - brew install pyenv
      - brew install pyenv
      - pyenv install 3.6
      - brew install ffmpeg
      - brew install python
    install:
      - pip install codecov
      - pip install -r requiremenets.txt
